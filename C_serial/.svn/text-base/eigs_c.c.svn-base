#include <stdio.h>
#include <stdlib.h>
#include <cblas.h>
#include "lapacke_mangling.h"
#include "lapacke.h"
#include <string.h>

void eigs_c(double *F, double *Es, double *l, int n_eigs, int n_patch)
{
	double *eigenvalue = (double *)malloc(n_patch*sizeof(double));
	lapack_int n = n_patch;
	LAPACKE_dsyevd(LAPACK_COL_MAJOR, 'V', 'U', n, l, n, eigenvalue);
	memcpy(F, l, n_eigs*n_patch*sizeof(double));
	memcpy(Es, eigenvalue, n_eigs*sizeof(double));
	free(eigenvalue);
}
